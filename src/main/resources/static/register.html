<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Register Page</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

        /* Reset */
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        body, html {
          height: 100%;
          overflow: hidden;
          font-family: 'Poppins', sans-serif;
          background: #0f2027;  /* fallback for older browsers */
          background: linear-gradient(45deg, #0f2027, #203a43, #2c5364);
          color: #eee;
          display: flex;
          justify-content: center;
          align-items: center;
          perspective: 1000px;
          user-select: none;
        }

        /* Animated background container */
        #bg {
          position: fixed;
          top: 0; left: 0;
          width: 120vw;
          height: 120vh;
          background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80') no-repeat center center/cover;
          filter: brightness(0.4);
          transform-origin: center;
          transition: transform 0.1s ease-out;
          z-index: -2;
        }
        /* Overlay with subtle shapes */
        #overlay {
          position: fixed;
          top: 0; left: 0; width: 100%; height: 100%;
          pointer-events: none;
          background:
            radial-gradient(circle at 30% 40%, rgba(255 255 255 / 0.08), transparent 70%),
            radial-gradient(circle at 70% 60%, rgba(255 255 255 / 0.04), transparent 70%);
          z-index: -1;
        }

        /* Container */
        .register-container {
          background: rgba(255 255 255 / 0.1);
          backdrop-filter: blur(10px);
          border-radius: 16px;
          box-shadow:
            0 8px 32px rgba(0,0,0,0.37),
            inset 0 0 60px rgba(255 255 255 / 0.1);
          width: 360px;
          max-width: 90vw;
          padding: 3rem 2.5rem 2rem;
          color: #fff;
          transform-style: preserve-3d;
          transition: box-shadow 0.3s ease;
        }
        .register-container:hover {
          box-shadow:
            0 12px 45px rgba(255 255 255, 0.6),
            inset 0 0 80px rgba(255 255 255 / 0.25);
        }

        h2 {
          font-weight: 600;
          text-align: center;
          margin-bottom: 2rem;
          letter-spacing: 1px;
          text-transform: uppercase;
          text-shadow: 0 0 5px rgb(255 255 255 / 0.25);
        }

        form {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          transform-style: preserve-3d;
        }

        label {
          font-weight: 600;
          font-size: 0.9rem;
          margin-bottom: 0.3rem;
          user-select: none;
          letter-spacing: 0.02em;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"] {
          padding: 0.75rem 1rem;
          font-size: 1rem;
          border: none;
          border-radius: 40px;
          background: rgba(255 255 255 / 0.15);
          color: #eee;
          outline: none;
          box-shadow:
            inset 0 0 8px rgba(255 255 255 / 0.15);
          transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
          user-select: text;
        }
        input[type="text"]::placeholder,
        input[type="email"]::placeholder,
        input[type="password"]::placeholder {
          color: #ccc;
        }
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus {
          background: rgba(255 255 255 / 0.35);
          box-shadow:
            0 0 12px 2px #71b7ff;
          transform: scale(1.05);
          color: #222;
        }

        /* Buttons container */
        .btns {
          display: flex;
          gap: 1rem;
          justify-content: center;
          margin-top: 1rem;
          flex-wrap: wrap;
        }

        button {
          flex: 1 1 140px;
          padding: 0.75rem 1.5rem;
          font-weight: 700;
          font-size: 1.1rem;
          border: none;
          border-radius: 40px;
          cursor: pointer;
          color: #0f2027;
          background: linear-gradient(45deg, #42a5f5, #1e88e5);
          box-shadow:
            0 0 12px #1e88e5,
            0 4px 20px rgba(66,165,245,0.6);
          transition:
            background 0.4s ease,
            box-shadow 0.4s ease,
            transform 0.2s ease;
          user-select: none;
          position: relative;
          overflow: hidden;
        }
        button:focus {
          outline: 2px solid #90caf9;
          outline-offset: 2px;
        }
        button:hover {
          background: linear-gradient(45deg, #1e88e5, #42a5f5);
          box-shadow:
            0 0 18px #42a5f5,
            0 6px 25px rgba(30,136,229,0.9);
          transform: translateY(-3px);
        }
        button:active {
          transform: translateY(0);
          box-shadow:
            0 0 8px #1976d2;
        }

        button.login {
          background: linear-gradient(45deg, #7b1fa2, #ab47bc);
          color: #fff;
          box-shadow:
            0 0 14px #ab47bc,
            0 5px 22px rgba(171,71,188,0.75);
        }
        button.login:hover {
          background: linear-gradient(45deg, #9c27b0, #ce93d8);
          box-shadow:
            0 0 22px #ce93d8,
            0 6px 25px rgba(156,39,176,0.95);
          transform: translateY(-3px);
        }
        button.login:active {
          box-shadow:
            0 0 10px #7b1fa2;
        }

        /* Small mobile fix */
        @media (max-width: 400px) {
          .register-container {
            width: 90vw;
            padding: 2rem 1.5rem 1.5rem;
          }
          button {
            flex-basis: 100%;
          }
        }
    </style>
</head>
<body>
<div id="bg"></div>
<div id="overlay"></div>

<main class="register-container" role="main" aria-label="User Registration Form">
    <h2>Create Account</h2>
    <form id="registerForm" novalidate autocomplete="off" aria-describedby="form-desc">
        <p id="form-desc" class="sr-only">Please fill in username, email and password to register. Use the buttons to submit your information or go to login page.</p>

        <label for="username">Username</label>
        <input
                type="text"
                id="username"
                name="username"
                placeholder="Your Username"
                autocomplete="username"
                minlength="3"
                maxlength="20"
                pattern="^[a-zA-Z0-9_]+$"
                required
                aria-required="true"
                aria-describedby="usernameHelp"
        />
        <small id="usernameHelp" style="color:#bbb; font-size:0.8rem; margin-top: -1rem; margin-bottom:1rem; display:block;">
            Only letters, numbers & underscore; 3 to 20 chars.
        </small>

        <label for="email">Email</label>
        <input
                type="email"
                id="email"
                name="email"
                placeholder="you@example.com"
                autocomplete="email"
                required
                aria-required="true"
        />

        <label for="password">Password</label>
        <input
                type="password"
                id="password"
                name="password"
                placeholder="Create a password"
                minlength="6"
                autocomplete="new-password"
                required
                aria-required="true"
        />

        <div class="btns">
            <button type="submit" aria-label="Register account">Register</button>
            <button type="button" class="login" aria-label="Go to login page" id="loginBtn">Login</button>
        </div>
    </form>
</main>

<script>
    const bg = document.getElementById('bg');
    const container = document.querySelector('.register-container');

    window.addEventListener('mousemove', e => {
      let x = (e.clientX / window.innerWidth) - 0.5;
      let y = (e.clientY / window.innerHeight) - 0.5;

      let bgTranslateX = x * -15;
      let bgTranslateY = y * -15;
      bg.style.transform = `translate3d(${bgTranslateX}px, ${bgTranslateY}px, 0) scale(1.05)`;

      let rotateX = y * 10;
      let rotateY = x * 10;
      container.style.transform = `rotateX(${-rotateX}deg) rotateY(${rotateY}deg)`;
    });

    window.addEventListener('mouseout', () => {
      bg.style.transform = 'translate3d(0,0,0) scale(1.05)';
      container.style.transform = 'rotateX(0deg) rotateY(0deg)';
    });

    const form = document.getElementById('registerForm');
    form.addEventListener('submit', async e => {
        let username = document.getElementById('username').value;
        let email = document.getElementById('email').value;
        let password = document.getElementById('password').value;
      e.preventDefault();
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }
      let result = await submit(username,email,password);
      if(result.includes("success")){
            alert(`Thank you for registering, ${form.username.value}!`);
            window.location.href = "login.html";
      }
      else{
        alert(`${result}!`);
      }
    });

    document.getElementById('loginBtn').addEventListener('click', () => {
      window.location.href = "login.html";

    });

    async function submit(username,email,password) {
        let result = await fetch("http://localhost:9090/api/user/register",{
            method : "POST",
            headers : { "Content-Type" : "application/json" },
            body:JSON.stringify({
                "username":username,
                "email" : email,
                "password":password
            })
        })

        return await result.text();
    }



</script>

<style>
    .sr-only {
      border: 0 !important;
      clip: rect(1px, 1px, 1px, 1px) !important;
      -webkit-clip-path: inset(50%) !important;
              clip-path: inset(50%) !important;
      height: 1px !important;
      margin: -1px !important;
      overflow: hidden !important;
      padding: 0 !important;
      position: absolute !important;
      width: 1px !important;
      white-space: nowrap !important;
    }
</style>
</body>
</html>